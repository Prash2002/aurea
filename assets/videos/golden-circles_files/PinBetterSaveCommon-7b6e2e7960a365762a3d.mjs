(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["PinBetterSaveCommon"],{"0zyx":function(e,t,n){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var a=n("mVx/"),o=n.n(a);const r=({pathname:e})=>/^\/pin\/[\w-]+\/?$/.test(e),i=e=>{const t=o()(e,e=>!r(e));return t&&(({pathname:e})=>/^\/search\/pins\//.test(e))(t)?(({pathname:e,search:t})=>{const n=/^\/search\/pins\/(\?.*)$/.exec(e),a=(t||n&&n[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return a?decodeURIComponent(a[1]):""})(t):""}},"1vym":function(e,t,n){},"7vSn":function(e,t,n){},EuRG:function(e,t,n){function a(e,t){return{type:"SEARCH_PIN_CLOSEUP_VIEWED",payload:{pinId:e,query:t}}}function o(e){return{type:"SEARCH_QUERY_STARTED",payload:{query:e}}}function r(e){return{type:"SEARCH_QUERY_INVALIDATED",payload:{query:e}}}n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r}))},"H/Lk":function(e,t,n){n.d(t,"a",(function(){return a}));const a=(e,t,n)=>({type:"MOST_RECENT_BOARD",payload:{id:e,name:t,url:n}})},JELi:function(e,t,n){var a=n("KwMD"),o=n("ut/Y"),r=n("Sxd8"),i=Math.max,s=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var d=c-1;return void 0!==n&&(d=r(n),d=n<0?i(c+d,0):s(d,c-1)),a(e,o(t,3),d,!0)}},KwMD:function(e,t){e.exports=function(e,t,n,a){for(var o=e.length,r=n+(a?1:-1);a?r--:++r<o;)if(t(e[r],r,e))return r;return-1}},WnNx:function(e,t,n){function a(e){return{type:"SHOW_REPIN_ANIMATION",payload:{pinId:e}}}function o(){return{type:"HIDE_REPIN_ANIMATION"}}function r(){return{type:"SHOW_USECASE_FLYOUT"}}function i(){return{type:"HIDE_USECASE_FLYOUT"}}n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return i}))},XKAG:function(e,t,n){var a=n("ut/Y"),o=n("MMmD"),r=n("7GkX");e.exports=function(e){return function(t,n,i){var s=Object(t);if(!o(t)){var c=a(n,3);t=r(t),n=function(e){return c(s[e],e,s)}}var d=e(t,n,i);return d>-1?s[c?t[d]:d]:void 0}}},ZdPf:function(e,t,n){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i}));const a={CONDITIONAL:0,EMOTIONAL_DISDRESS_OR_SUICIDE:4},o={ABUSIVE:0,SENSITIVE:1,BRAND_UNSAFE:2};function r(e){return null!=e&&(!!e.notice||!!e.notices&&e.notices.length>0)}function i(e){return!!e&&e.severity===o.ABUSIVE}},a49R:function(e,t,n){n.d(t,"a",(function(){return s}));var a=n("q1tI"),o=n.n(a),r=(n("17x9"),n("n6mq"));function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=o.a.createContext(()=>{}),c=752;t.b=class extends a.Component{constructor(...e){super(...e),i(this,"state",{flyout:void 0,showOnTopOfModal:!1}),i(this,"setActive",(e,t,n=!1)=>{if(e){const e={...t,onDismiss:()=>{t&&t.onDismiss&&(t.onDismiss(),this.setState({flyout:void 0}))},positionRelativeToAnchor:!1};this.setState({flyout:{props:e},showOnTopOfModal:n})}else this.setState({flyout:void 0})})}render(){var e,t,n,a,i,d,l,u,h;const{flyout:p,showOnTopOfModal:m}=this.state,{children:g}=this.props;return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.Provider,{value:this.setActive},g),p&&o.a.createElement("div",m?{style:{zIndex:c,position:"absolute",top:0}}:{},o.a.createElement(r.n,{anchor:null===(e=p.props)||void 0===e?void 0:e.anchor,onDismiss:null===(t=p.props)||void 0===t?void 0:t.onDismiss,color:null===(n=p.props)||void 0===n?void 0:n.color,idealDirection:null===(a=p.props)||void 0===a?void 0:a.idealDirection,positionRelativeToAnchor:null===(i=p.props)||void 0===i?void 0:i.positionRelativeToAnchor,shouldFocus:null===(d=p.props)||void 0===d?void 0:d.shouldFocus,showCaret:null===(l=p.props)||void 0===l?void 0:l.showCaret,size:null===(u=p.props)||void 0===u?void 0:u.size},null===(h=p.props)||void 0===h?void 0:h.children)))}}},e0nq:function(e,t,n){function a(e){return{type:"PIN_BETTER_SAVE",payload:e}}function o(e){return{type:"PIN_BETTER_UNSAVE",payload:e}}function r(e){return{type:"PIN_BETTER_SELECT_BOARD_OR_SECTION",payload:e}}function i(e){return{type:"POST_REPIN_MORE_IDEAS_UPSELL_SHOWN",payload:{boardId:e}}}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}))},e3KR:function(e,t,n){var a=n("q1tI"),o=n.n(a),r=n("/MKj"),i=(n("7vSn"),n("8cMa")),s=n("n6mq");var c=({isOpen:e,showCollaborativeIcon:t,showPrivateIcon:n,showProtectedIcon:a,showSectionsIcon:r})=>t||n||a||r?o.a.createElement(s.d,{display:"flex",direction:"row",marginEnd:5,dangerouslySetInlineStyle:{__style:{paddingLeft:8}},alignItems:"center"},n&&o.a.createElement(i.a,{type:"secret"}),a&&o.a.createElement(i.a,{type:"protected"}),t&&o.a.createElement(i.a,{type:"group"}),r&&o.a.createElement(i.a,{type:"sections"})):null,d=n("JW66"),l=n("Ye/N"),u=n("4cpq");function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p=52;class m extends a.Component{constructor(...e){super(...e),h(this,"state",{hovered:!1}),h(this,"handleMouseEnter",()=>{this.setState({hovered:!0})}),h(this,"handleMouseLeave",()=>{this.setState({hovered:!1})}),h(this,"handleTouch",()=>{const{board:e,onClick:t}=this.props;t(e)}),h(this,"handleButtonClick",({event:e})=>{const{onButtonClick:t}=this.props;this.handleTouch(),t&&t(),e.stopPropagation()}),h(this,"tapAreaRef",Object(a.createRef)())}focus(){const e=this.tapAreaRef.current;e&&e.focus()}render(){const{hovered:e}=this.state,{board:t,buttonText:n,isSectionOpen:a,shouldOpenSections:r,showFlyoutSaveButton:i}=this.props,h=!!t.section_count&&t.section_count>0,m=h?"boardWithSection":"boardWithoutSection",g=t.image_cover_url;return o.a.createElement(u.a,{id:m},o.a.createElement(s.Q,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTap:this.handleTouch,ref:this.tapAreaRef},o.a.createElement(s.d,{color:e?"lightGray":"white",display:"flex",alignItems:"center",height:p,marginStart:3,marginEnd:3,marginBottom:1,marginTop:1,rounding:3},o.a.createElement(s.d,{flex:"none",marginBottom:1,marginStart:2,marginEnd:3,marginTop:1,overflow:"hidden",width:36,height:36,rounding:2},g&&!r&&o.a.createElement(s.x,{wash:!0,width:36,height:36},o.a.createElement(s.s,{src:g,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"})),g&&r?o.a.createElement(s.x,{wash:!0,width:36,height:36},o.a.createElement(s.s,{src:g,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"})):o.a.createElement(s.d,{color:r?"lightGray":"transparent",width:"100%",height:"100%"})),o.a.createElement(s.d,{flex:"grow",paddingY:1,overflow:"hidden",marginStart:1},o.a.createElement(s.R,{truncate:!0,weight:r||!r?"bold":"normal"},t.name)),t&&(!e||e&&h&&!a)?o.a.createElement(s.d,null,o.a.createElement(c,{isOpen:t.isOpen,showCollaborativeIcon:!!t.is_collaborative,showPrivateIcon:t.privacy===d.a.BoardPrivacy.SECRET,showProtectedIcon:t.privacy===d.a.BoardPrivacy.PROTECTED,showSectionsIcon:h&&r})):null,e&&(0===t.section_count||!r)&&i&&o.a.createElement(s.d,{marginEnd:2,flex:"none"},o.a.createElement(s.e,{accessibilityLabel:"save button",color:"red",inline:!0,onClick:this.handleButtonClick,text:n||l.a._("Save","save button","save button")})))))}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}h(m,"defaultProps",{shouldOpenSections:!0,showFlyoutSaveButton:!0});const b=52,f=53,v=11;class S extends a.Component{constructor(...e){super(...e),g(this,"state",{hovered:!1}),g(this,"handleMouseEnter",()=>{this.setState({hovered:!0})}),g(this,"handleMouseLeave",()=>{this.setState({hovered:!1})}),g(this,"handleTouch",()=>{const{board:e,onClick:t,section:n}=this.props;t(n,e)}),g(this,"handleButtonClick",({event:e})=>{const{onButtonClick:t}=this.props;this.handleTouch(),t&&t(),e.stopPropagation()}),g(this,"tapAreaRef",Object(a.createRef)())}focus(){const e=this.tapAreaRef.current;e&&e.focus()}render(){const{hovered:e}=this.state,{buttonText:t,section:n,showSectionSaveButton:a}=this.props;return o.a.createElement(s.Q,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTap:this.handleTouch,ref:this.tapAreaRef},o.a.createElement(s.d,{color:e?"lightGray":"white",display:"flex",alignItems:"center",height:b,marginTop:1,rounding:3,dangerouslySetInlineStyle:{__style:{marginLeft:f,marginRight:v}}},o.a.createElement(s.d,{flex:"grow",paddingY:1,marginStart:4},o.a.createElement(s.R,{truncate:!0},n.title)),e&&a&&o.a.createElement(s.d,{marginEnd:2,flex:"none"},o.a.createElement(s.e,{accessibilityLabel:"save button",color:"red",inline:!0,text:t||l.a._("Save","save button","save button"),onClick:this.handleButtonClick}))))}}g(S,"defaultProps",{showSectionSaveButton:!0});var _=n("zLLH");var y=Object(_.c)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id})},{allowStale:!1})(e=>{const{board:t,buttonText:n,sectionsResource:a,onClick:r,onButtonClick:i,showSectionSaveButton:c}=e,d=a&&a.data||[];return o.a.createElement(s.d,null,!a.isLoaded&&o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},o.a.createElement(s.K,{accessibilityLabel:l.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})),a.isLoaded&&o.a.createElement(s.d,null,d.map(e=>o.a.createElement(S,{board:t,buttonText:n,key:e.id,onButtonClick:i,onClick:r,section:e,showSectionSaveButton:c}))))});function E({isBoardCreate:e,onCreateBoardClick:t}){const[n,r]=Object(a.useState)(!1);return o.a.createElement(s.d,{"data-test-id":"create-board",height:"100%",display:"flex"},o.a.createElement(s.Q,{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onTap:t,rounding:2},o.a.createElement(s.d,{display:"flex",alignItems:"center",color:n?"lightGray":"white",padding:2,width:"100%",height:"100%"},o.a.createElement(s.d,{marginEnd:5,marginStart:4},o.a.createElement(s.q,{accessibilityLabel:"",size:28,icon:"add-circle",color:"red"})),e?o.a.createElement(s.R,{align:"center",truncate:!0,weight:"bold"},l.a._("Create board")):o.a.createElement(s.R,{align:"center",truncate:!0,weight:"bold"},l.a._("Create section")))))}var w=n("nKlH");const B=52;function C({onClick:e,title:t}){const[n,r]=Object(a.useState)(!1);return o.a.createElement(s.Q,{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onTap:()=>{e({title:t})}},o.a.createElement(s.d,{color:n?"lightGray":"white",display:"flex",alignItems:"center",height:B,marginStart:3,marginEnd:3,marginBottom:1,rounding:3},o.a.createElement(s.d,{flex:"none",marginBottom:1,marginStart:2,marginEnd:3,marginTop:1,overflow:"hidden",width:36,height:36,rounding:1},o.a.createElement(s.d,{color:"lightGray",width:"100%",height:"100%"})),o.a.createElement(s.d,{flex:"grow",paddingY:1},o.a.createElement(s.R,{truncate:!0,weight:"bold"},t)),n&&o.a.createElement(s.d,{marginEnd:2},o.a.createElement(s.e,{accessibilityLabel:"create button",color:"red",inline:!0,text:l.a._("Create","create button to create a new board","create button to create a new board")}))))}const I=e=>{const{suggestionsResource:t,onClick:n,pinBuilderSuggestions:a}=e,r=a||t&&t.data||[],i=o.a.createElement(o.a.Fragment,null,r.map((e,t)=>o.a.createElement(C,{key:t,title:e.title,onClick:n})));return o.a.createElement(o.a.Fragment,null,r?i:o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},o.a.createElement(s.K,{accessibilityLabel:l.a._("loading board suggestions","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})))};var R=n("0BOE"),x=n("eUcp"),O=n("Wer7"),T=n("qyR9"),D=n("U4JR"),k=n("oTtT"),P=n("fArA");function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"c",(function(){return W})),n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return G}));const L=128.5,A=439,M=52;class F extends a.Component{constructor(...e){super(...e),j(this,"state",{isSectionOpen:null,selectedBoardId:"",selectedBoardCategory:"",searchQuery:"",searchBoxFocused:!0}),j(this,"getItems",()=>{const{boardResource:e,suggestedBoardsShortListResource:t}=this.props;if(!e||!e.data)return[];const{all_boards:n}=e&&e.data,a=n.filter(e=>!this.props.advertiser_id||"secret"!==e.privacy).map(e=>this.mapBoards(e,"allBoards",0)),o=(t&&t.data||[]).map((e,t)=>this.mapBoards(e,"shortlist",t+1)),{searchQuery:r}=this.state;return r.length>=T.a?[...Object(R.a)(a,r)]:[...a.length>3&&o&&o.length?[{type:"header",title:l.a._("Top board suggestions","Header for top suggesions in board picker","Header for top suggesions in board picker")},...o]:[],{type:"header",title:l.a._("All boards","Header for all boards in board picker","Header for all boards in board picker")},...a,...a.length<=3?[{type:"header",title:l.a._("Suggested board names","Header for suggested boards in board picker","Header for suggested boards in board picker")}]:[]]}),j(this,"mapBoards",(e,t,n)=>{const{setBoardWithSection:a}=this.props,{selectedBoardId:o,selectedBoardCategory:r}=this.state,i=e.id===o&&t===r;return i&&a&&a(e),{...e,category:t,isOpen:i,gridIndex:n}}),j(this,"handleBack",()=>{const{setBoardWithSection:e}=this.props;this.setState({isSectionOpen:!1,selectedBoardId:"",selectedBoardCategory:""}),e&&e(null)}),j(this,"handleSectionClick",(e,t)=>{const{onItemChosen:n}=this.props;Object(D.a)(101,{component:13282,element:36,objectId:t.id,view:91,grid_index:t.gridIndex}),n({boardId:t.id,url:e.slug?`${t.url}${e.slug}/`:t.url,sectionId:e.id,title:e.title||"",imageCoverUrl:t.image_cover_url})}),j(this,"handleBoardWithSectionsClick",e=>{const{selectedBoardId:t,selectedBoardCategory:n}=this.state,a=t===e.id&&n===e.category;this.setState({isSectionOpen:!0,selectedBoardId:a?"":e.id,selectedBoardCategory:a?"":e.category})}),j(this,"handleBoardClick",({board:e,toggleSections:t})=>{const{onItemChosen:n}=this.props;this.setState({searchBoxFocused:!1}),t?this.handleBoardWithSectionsClick({id:e.id,category:e.category}):(Object(D.a)(101,{component:13282,element:36,objectId:e.id,view:91,grid_index:e.gridIndex}),n({boardId:e.id,url:e.url,title:e.name||"",imageCoverUrl:e.image_cover_url}))}),j(this,"handleSearchQueryUpdate",e=>{this.setState(t=>({...t,searchQuery:e}))}),j(this,"boardSectionsHeaderRef",Object(a.createRef)())}componentDidMount(){this.props.boardResource&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd()}componentDidUpdate(e,t){e.boardResource&&!e.boardResource.isLoaded&&this.props.boardResource&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd(),this.state.isSectionOpen&&!t.isSectionOpen&&this.boardSectionsHeaderRef.current&&this.boardSectionsHeaderRef.current.focus()}setPWTLoadingEnd(){const{boardResource:e,boardPickerStopwatch:t}=this.props;t&&(!e||e.error?t.error():t.stop())}render(){const{boardResource:e,buttonText:t,customItem:n,onBoardCreate:a,onButtonClick:r,paneWidth:i,showCreateBoardButton:c,showFlyoutSaveButton:d,showSections:h,showSectionSaveButton:p,suggestedBoardsShortListResource:g,useStoryboardStyle:b}=this.props,{isSectionOpen:f,searchBoxFocused:v,searchQuery:S}=this.state;if(!e)return null;const{isLoaded:_,data:B,error:C}=e;let R=[];(_&&!C||g&&g.data&&!g.error)&&(R=this.getItems());const O=R.filter(e=>e&&"allBoards"===e.category).length,T=b?200:322,D=b?214:334,k=null===f?"":"BoardsSlideRight",P=_&&B&&B.create_suggestions.map(e=>({title:e}))||[],j=e=>o.a.createElement(o.a.Fragment,null,o.a.createElement(s.l,null),o.a.createElement(s.d,{overflow:"hidden",height:M,dangerouslySetInlineStyle:{__style:{borderBottomRightRadius:8,borderBottomLeftRadius:8}}},o.a.createElement(E,{onCreateBoardClick:()=>a({title:this.state.searchQuery}),isBoardCreate:e})));return o.a.createElement(s.d,{width:"100%",rounding:2,overflow:"hidden",height:b?"100%":A,color:"white",zIndex:x.a},_?null:o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:i,height:"100%",minHeight:200},o.a.createElement(s.K,{accessibilityLabel:l.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})),o.a.createElement(s.d,{display:"flex",direction:"row"},_&&o.a.createElement("div",{className:f?"BoardsSlideLeft":k},o.a.createElement(s.d,{position:"relative"},o.a.createElement(s.d,{display:"flex",direction:"row",width:2*i,zIndex:new s.m(0)},o.a.createElement(s.d,{display:"flex",direction:"column",width:i},o.a.createElement(s.d,{padding:3},o.a.createElement(w.a,{accessibilityLabel:l.a._("Search through your boards","search bar placeholder text","search bar placeholder text"),focused:v,id:"pickerSearchField",onChange:({value:e})=>this.handleSearchQueryUpdate(e),placeholder:l.a._("Search","search bar placeholder text","search bar placeholder text"),value:S})),o.a.createElement(s.d,{minHeight:T,maxHeight:T,overflow:"scrollY"},g&&!g.isLoaded?o.a.createElement(u.a,{id:"suggestedBoardsContainer"},o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:L},o.a.createElement(s.K,{accessibilityLabel:l.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0}))):null,n,R.map((e,n)=>"header"===e.type?o.a.createElement(s.d,{key:e.title,paddingX:3,paddingY:1,marginTop:n>0?2:1},o.a.createElement(s.R,{size:"md"},e.title)):o.a.createElement(s.d,{key:`${e.category}-${e.id}`},o.a.createElement(m,{board:e,buttonText:t,onClick:e=>{this.handleBoardClick({board:e,toggleSections:h&&!!e.section_count})},onButtonClick:r,shouldOpenSections:h,showFlyoutSaveButton:d}))),O<=3&&o.a.createElement(I,{onClick:a,pinBuilderSuggestions:P})),c&&j(!0)),o.a.createElement(s.d,{display:"flex",direction:"column",width:i},o.a.createElement(s.d,{display:"flex",direction:"row",justifyContent:"center",alignContent:"center",alignItems:"center"},o.a.createElement(s.i,{span:2},o.a.createElement(s.d,{display:"flex",justifyContent:"start",alignContent:"center",alignItems:"center",marginStart:3},o.a.createElement(s.r,{accessibilityLabel:"Back button",icon:"arrow-back",iconColor:"darkGray",onClick:this.handleBack,size:"sm"}))),o.a.createElement(s.i,{span:8},o.a.createElement(s.d,{display:"flex",justifyContent:"center",alignItems:"center",height:52},o.a.createElement(s.R,{weight:"bold"},l.a._("Choose section","Header for section header","Header for section header")))),o.a.createElement(s.i,{span:2},o.a.createElement(s.d,null))),o.a.createElement(s.l,null),o.a.createElement(s.d,{minHeight:D,maxHeight:D,overflow:"scrollY"},R?o.a.createElement(o.a.Fragment,null,R&&R.map((e,n)=>"header"===e.type?null:o.a.createElement(s.d,{key:`${e.category}-${e.id}`},e.isOpen&&o.a.createElement(o.a.Fragment,null,o.a.createElement(m,{board:e,buttonText:t,isSectionOpen:!0,onClick:e=>{this.handleBoardClick({board:e,toggleSections:!1})},onButtonClick:r,shouldOpenSections:!1,showFlyoutSaveButton:d,ref:this.boardSectionsHeaderRef}),o.a.createElement(y,{board:e,buttonText:t,onClick:this.handleSectionClick,onButtonClick:r,showSectionSaveButton:p}))))):null),c&&j(!1)))))))}}function H(e){const t=Object(k.b)();return o.a.createElement(F,Object.assign({},e,{boardPickerStopwatch:t}))}function N(e){const{advertiser:t,viewer:n}=e;if(n&&t){const t=e.advertiser;if(n.isAuth&&t.owner_user_id!==n.id)return{hasMUA:!0,advertiser_id:t.id,username:t.owner_user_id};if(n.isAuth&&t.owner_user_id===n.id)return{hasMUA:!1,advertiser_id:t.id,username:"me"}}return{advertiser_id:void 0,hasMUA:void 0,username:void 0}}function U(e){const{advertiser_id:t,hasMUA:n,username:a}=e;return{field_set_key:"board_picker",filter:n?"protected":"all",...a?{username:a}:{},...t?{advertiser_id:t}:{}}}function W(){return(e,t)=>e(Object(O.f)("BoardPickerBoardsResource",U(N(t()))))}j(F,"defaultProps",{paneWidth:320,showCreateBoardButton:!0,showFlyoutSaveButton:!0,showSections:!0,showSectionSaveButton:!0});const q=Object(P.compose)(Object(r.connect)((function(e){return N(e)})),Object(_.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:U}))(H),G=Object(_.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsShortListResource",options:e=>({pin_id:e.pin.id,shortlist_length:3,num_shortlist_suggestions:3})})(H)},eUcp:function(e,t,n){n.d(t,"i",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"l",(function(){return g}));var a=n("n6mq");const o=new a.m(0),r=new a.m(1),i=2,s=new a.m(i),c=2,d=new a.m(c),l=new a.m(3),u=new a.m(1),h=new a.m(3),p=3,m=4,g=(new a.m(m),new a.m(100))},fEA9:function(e,t,n){n.r(t);var a=n("q1tI"),o=n.n(a),r=n("/MKj"),i=n("qWlA"),s=(n("1vym"),n("TSYQ")),c=n.n(s),d=n("Ye/N"),l=n("pLLR"),u=n("n6mq");function h(e){const{dropdownRef:t,onBoardDropdownClick:n,onSaveClick:r,renderPinSaveTooltip:i,selectedTitle:s,showSaveButton:h,unselectedText:p,variant:m}=e,{isRTL:g}=Object(l.d)(),b=Object(a.useRef)();return o.a.createElement(u.d,{alignItems:"center",display:"flex",width:"100%",height:44},o.a.createElement("button",{className:c()("PinBetterSave__Dropdown","PinBetterSave__Dropdown--lego",{"PinBetterSave__Dropdown--rtl":g,"PinBetterSave__Dropdown--lego-pin":"pin"===m,"PinBetterSave__Dropdown--lego-closeup":"closeup"===m,"PinBetterSave__Dropdown--expandedLego":!h}),"data-test-id":"PinBetterSaveDropdown",onClick:n,ref:t},o.a.createElement(u.d,{paddingX:4,display:"flex",flex:"grow",alignItems:"center"},o.a.createElement(u.d,{flex:"grow",overflow:"hidden"},o.a.createElement(u.R,{color:s?"darkGray":"gray",truncate:!0,size:"sm"},o.a.createElement("span",{className:c()("PinBetterSave__DropdownText","PinBetterSave__DropdownText--lego")},s||p))),o.a.createElement(u.d,{marginStart:2,flex:"none","data-test-id":"boardSelectionDropdown"},o.a.createElement("div",{className:c()("PinBetterSave__DownArrowContainer","PinBetterSave__DownArrowContainer--lego")},o.a.createElement(u.q,{accessibilityLabel:d.a._("Select a board you want to save to","BetterSave accessibility label to change the board","BetterSave accessibility label to change the board"),color:"darkGray",icon:"arrow-down",size:12}))))),h&&o.a.createElement(a.Fragment,null,o.a.createElement("button",{className:c()("PinBetterSave__Button","PinBetterSave__Button--lego",{"PinBetterSave__Button--rtl":g,"PinBetterSave__Button--lego-pin":"pin"===m}),onClick:r,"data-test-id":"PinBetterSaveButton",ref:b},o.a.createElement(u.R,{color:"white",size:"sm",weight:"bold"},d.a._("Save","BetterSave Save label","BetterSave Save label"))),!!i&&!!b.current&&i(b.current)))}var p=n("clxp"),m=n("1inl"),g=n("ajUs"),b=n("a49R");class f extends a.Component{constructor(...e){var t,n,a;super(...e),a=()=>{const{setActive:e,showOnTopOfModal:t,...n}=this.props;e("flyout",n,t||!1)},(n="renderFlyout")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}componentDidMount(){this.renderFlyout()}componentDidUpdate(){this.renderFlyout()}componentWillUnmount(){this.props.setActive()}render(){return null}}const v=e=>a.createElement(b.a.Consumer,null,t=>a.createElement(f,Object.assign({},e,{setActive:t})));v.displayName="MasonryFlyout";var S=v,_=n("3gA6"),y=n("eOdZ"),E=n("/5zs"),w=n("lm6u");const B=(e,t)=>{const[n,o]=Object(a.useState)([]),r=Object(l.d)();return Object(a.useEffect)(()=>{let n=!1;if(e){new E.c(r,"web_board_section_templates").enabled()&&y.a.create("SectionRecommendationsResource",{pinIds:[t]}).callGet().then(e=>{var t;if(n)return;const a=null==e?void 0:null===(t=e.resource_response)||void 0===t?void 0:t.data;o(a.length>0&&a[0]||[])})}return()=>{n=!0}},[e,t]),n};function C(e){const{action:t,additionalCreateFields:n,boardWithSection:a,children:r,onClose:i,pin:s,setCompletionPromise:c,showModal:d}=e,l=B(d,s.id);return o.a.createElement(w.a,{additionalCreateFields:n,boardWithSection:a,action:t,hideSuccessAnimation:!!l.length,onClose:i,setCompletionPromise:c,showCreate:!0,shouldShowToast:!l.length,pin:s},e=>r({...e,sectionSuggestions:l}))}var I=n("jHGc");function R(e){const{children:t,currentCarouselIndex:n,onDeleteSavedState:a,onEditSubmit:r,onToggleModal:i,pinId:s,variant:c,viewParameter:d}=e,l="pin"===c?{bgColor:"white",iconColor:"darkGray",size:"sm"}:{bgColor:"transparent",iconColor:"darkGray",size:"sm"};return o.a.createElement(u.d,{display:"flex",direction:"row",alignItems:"center",width:"closeup"===c?"100%":void 0,paddingX:"closeup"===c?2:void 0,marginStart:"pin"===c?-1:void 0,marginEnd:"pin"===c?-1:void 0},t&&o.a.createElement(u.d,{paddingX:1,"data-test-id":"saved-info",flex:"grow"},t),o.a.createElement(u.d,{paddingX:1,flex:"none",marginStart:"auto"},o.a.createElement(I.default,{component:0,onDelete:a,onSubmit:r,pinId:s,onToggleModal:i,viewParameter:d,carouselSlotCurrentIndex:n,style:l,useLegoStyles:"pin"===c})))}var x=n("e3KR"),O=n("Wrea"),T=n("fArA"),D=n("0zyx"),k=n("TN0d"),P=n("vvax"),j=n("EuRG"),L=n("H/Lk"),A=n("WnNx"),M=n("U4JR"),F=n("NjDU"),H=n("CvCA"),N=n("e0nq");const U=5e3,W=16,q=({boardId:e,boardUrl:t,postRepinMoreIdeasUpsell:n})=>{if(!t)return!1;const{recentSaves:a,recentUpsell:o}=n;if(o[e])return!1;const r=a.findIndex(t=>t.boardId!==e);return(-1===r?a.length:r)+1>=3};var G=Object(r.connect)(null,(e,t)=>({toastShown:()=>e(Object(N.c)(t.boardId))}))(class extends a.PureComponent{constructor(...e){var t,n,a;super(...e),a=()=>{const{boardId:e}=this.props;Object(M.a)(101,{component:20,element:10805,objectId:e})},(n="handleClick")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}componentDidMount(){const{toastShown:e}=this.props;e()}render(){const{boardName:e,boardUrl:t,onHide:n}=this.props;return a.createElement(H.a,{duration:U,onHide:n,text:Object(P.b)(d.a._("Find more ideas for {{ boardName }}"),{boardName:e}).join(""),href:`${t}more_ideas/?ideas_referrer=${W}`,onClick:this.handleClick})}}),z=n("zLLH"),Q=n("C0mq"),K=n("ZdPf"),Y=n("B6Tf"),$=n("oTtT"),V=n("nGHF"),X=n("0nTG");function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"PinBetterSave",(function(){return te}));const Z=4;function ee({savedInfo:e,variant:t}){const n="closeup"===t,a=n?"sm":"md";return o.a.createElement(_.b,{className:"underlineLink",stopPropagation:!0,style:{color:"#333"},to:e.url||""},o.a.createElement(u.d,{marginStart:n?1:0},o.a.createElement(u.R,{color:"darkGray",inline:!0,size:a},Object(P.b)(d.a._("Saved to {{ destination }}","Saved to label for better save","Saved to label for better save"),{destination:o.a.createElement(u.R,{color:"darkGray",key:"pin_auto_save_link",size:a,truncate:!0,weight:"bold"},e.title)}))))}class te extends o.a.Component{constructor(...e){var t;super(...e),t=this,J(this,"state",{boardWithSection:null,createdBoard:null,suggestedBoardTitle:"",showBoardFlyout:!1,showRepinModal:!1,sensitiveContentNotice:null}),J(this,"setBoardSaveCompletionPromise",e=>{const{createdBoard:t}=this.state;this._repinCompletionPromise=e,this._repinCompletionPromise.promise.then(e=>{if(!e.board)return;const{board:{id:n,name:a,url:o}}=e,r={boardId:n,title:a,url:o};this.updateSelectedBoardOrSection(r),this.updateSavedState({...r,localPinId:e.id}),t&&Object(K.d)(t.sensitivity)&&Object(K.c)(t.sensitivity)?this.setState({sensitiveContentNotice:t.sensitivity.notice||t.sensitivity.notices[0]}):this.handleRepinHide()})}),J(this,"updateSavedState",e=>{const{reduxLocation:t,save:n,searchQueryInvalidated:a,onSave:o,pin:{id:r}}=this.props,i=t.query&&t.query.q||Object(D.a)(t.history);n({pinId:r,...e}),i&&a(i),o&&o()}),J(this,"updateSelectedBoardOrSection",e=>{const{selectBoardOrSection:t,pin:{id:n}}=this.props;t({pinId:n,...e})}),J(this,"updateSelectedItem",()=>{const{initialSelection:e,selectedItem:t}=this.props;!t&&e&&this.updateSelectedBoardOrSection(e)}),J(this,"dropdownRef",o.a.createRef()),J(this,"handleItemChosen",e=>{this.updateSelectedBoardOrSection(e),this.hideFlyout(!0),this.save(e)}),J(this,"handleBoardCreate",Object(i.a)(({title:e=""}={})=>{this.hideFlyout(!0),this.setState(t=>({...t,suggestedBoardTitle:e,showRepinModal:!0}));const{onToggleFlyout:t}=this.props;t&&t(!0,!0)})),J(this,"handleBoardCreated",e=>{this.setState({createdBoard:e})}),J(this,"handleRepinHide",()=>{this.setState(e=>({...e,suggestedBoardTitle:"",showRepinModal:!1}));const{onToggleFlyout:e}=this.props;e&&e(!1,!1)}),J(this,"handleBoardDropdownClick",e=>{const{pin:{id:t},viewParameter:n,boardPickerStopwatch:a}=this.props;e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),this.state.showBoardFlyout?this.hideFlyout(!0):(Object(M.a)(101,{component:13282,element:10960,viewParameter:n,objectId:t}),a&&a.start(),this.showFlyout())}),J(this,"handleSaveClick",(async function(e){const{selectedItem:n}=t.props;n?(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),Object(M.a)(101,{component:13282,element:36,objectId:n.boardId,grid_index:Z}),await t.save(n)):t.handleBoardDropdownClick(e)})),J(this,"setBoardWithSection",e=>{this.setState({boardWithSection:e})}),J(this,"handleEditSubmit",({boardId:e,sectionId:t,url:n,title:a})=>{const{pin:{id:o},savedInfo:{localPinId:r}={}}=this.props;this.updateSavedState({pinId:o,localPinId:r,boardId:e,sectionId:t||"",url:n,title:a})}),J(this,"resetPinSavedState",()=>{this.updateSavedState({boardId:"",localPinId:"",sectionId:"",title:"",url:""})}),J(this,"deleteSavedState",()=>{const{unsave:e,onDelete:t,pin:{id:n}}=this.props;e({pinId:n}),t&&t()}),J(this,"save",(async function(e){const{isLimitedLogin:n,mostRecentBoard:a,pin:{id:r},postRepinMoreIdeasUpsell:i,postRepinUpsellDisabled:s,save:c,setMostRecentBoard:d,showRepinAnimation:l,toastManagerContext:u}=t.props;t.updateSavedState(e);try{const{resource_response:{data:n}}=await t.getPinResource(e).callCreate({showError:!1}),h=e.url,{incrementBoardPinCount:p,updateUserPinCount:m,viewerUserId:g}=t.props;!s&&h&&q({boardId:e.boardId,boardUrl:h,postRepinMoreIdeasUpsell:i})&&u.showToast(({onHide:t})=>o.a.createElement(G,{boardId:e.boardId,boardName:e.title,boardUrl:h,onHide:t})),c({pinId:r,...e,localPinId:n.id}),k.b.publish("currentUser","pinCreated",n),k.b.publish(n.board.id,"pinCreated",{pin:n}),p({boardId:e.boardId,sectionId:e.sectionId}),m(g),l(r),a&&e.boardId!==a.id&&d(e.boardId,e.title,e.url)}catch(h){n||m.a.showError(h.message_detail||h.message),t.resetPinSavedState()}})),J(this,"hideFlyout",(e=!1)=>{const{onToggleFlyout:t}=this.props;this.setState({showBoardFlyout:!1}),t&&t(!1,e)})}componentDidMount(){const{onMount:e}=this.props;this.updateSelectedItem(),e&&e()}componentDidUpdate(e,t){this.updateSelectedItem()}getPinResource(e){const{carousel_data:t,location:n,previousHistory:a,pin:o}=this.props,r=t&&t.index,i=Object(g.a)(o,n,a)||`${o.tracking_params}~0`,s={description:o.description||"",link:o.link,title:o.title||"",clientTrackingParams:i,board_id:e.boardId||"",pin_id:o.id||"",image_base64:o.image_base64,is_buyable_pin:!1,is_removable:o.promoted_is_removable,carousel_slot_index:r||0,...e.sectionId?{section:e.sectionId}:{},...Object(X.a)(o)||{}};return y.a.create("RepinResource",s)}showFlyout(){const{onToggleFlyout:e}=this.props;this.setState({showBoardFlyout:!0}),e&&e(!0,!0)}render(){const{boardResource:e,useMasonryFlyout:t,onToggleModal:n,pin:a,renderSavedStatus:r,renderPinSaveTooltip:i,selectedItem:s,savedInfo:c,unselectedText:d,variant:l,viewParameter:m}=this.props,{boardWithSection:g,showBoardFlyout:b,showRepinModal:f,sensitiveContentNotice:v,suggestedBoardTitle:_}=this.state,y=t?S:u.n,{carousel_data:E}=a,w=o.a.createElement(x.a,{boardResource:e,setBoardWithSection:this.setBoardWithSection,onItemChosen:this.handleItemChosen,onBoardCreate:this.handleBoardCreate,pin:a});return o.a.createElement(p.a,{name:"PinBetterSave"},o.a.createElement(u.d,{width:"100%",display:"closeup"===l?"flex":void 0,height:"closeup"===l?44:void 0,color:"closeup"===l?"lightGray":void 0,rounding:"closeup"===l?4:void 0},(null==c?void 0:c.title)?o.a.createElement(R,{currentCarouselIndex:E&&E.index,onDeleteSavedState:this.deleteSavedState,onEditSubmit:this.handleEditSubmit,onToggleModal:n,pinId:c.localPinId,variant:l,viewParameter:m},r&&c&&r({savedInfo:c,variant:l})):o.a.createElement(h,{dropdownRef:this.dropdownRef,onBoardDropdownClick:this.handleBoardDropdownClick,onSaveClick:this.handleSaveClick,renderPinSaveTooltip:i,selectedTitle:s&&s.title,showSaveButton:!b,unselectedText:d,variant:l}),o.a.createElement(C,{additionalCreateFields:{is_stl_pin:Object(X.g)(a)},boardWithSection:g,action:"create",onClose:this.handleRepinHide,setCompletionPromise:this.setBoardSaveCompletionPromise,showModal:f,pin:a},({boardSavedTo:e,dismissModal:t,displaySuccessAnimation:n,handleAbort:a,handleNewBoardAnimationCompletion:r,handleSocialConnectSet:i,handleSaveToBoard:s,newPin:c,updateDescription:d,modalTitle:l,sectionSuggestions:u,setModalTitle:h,pin:p})=>o.a.createElement(Y.b,{boardSavedTo:e,isInModal:!0,displaySuccessAnimation:n,dismissModal:t,handleAbort:a,handleNewBoardAnimationCompletion:r,handleSocialConnectSet:i,handleSaveToBoard:s,updateDescription:d,onBoardCreated:this.handleBoardCreated,sensitiveContentNotice:v,pin:p,pwtAuxData:{pin_create_method:"repin"},sectionSuggestions:u,suggestedBoardTitle:_,boardWithSection:g,shouldRenderContent:f,newPin:c,modalTitle:l,setModalTitle:h,showCreate:!0})),b&&"closeup"===l&&o.a.createElement(u.n,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,size:"lg"},w),b&&"pin"===l&&o.a.createElement(y,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,positionRelativeToAnchor:!t,size:"lg"},w)))}}J(te,"defaultProps",{variant:"pin",renderSavedStatus:({savedInfo:e,variant:t})=>o.a.createElement(ee,{savedInfo:e,variant:t})});t.default=o.a.memo(Object(T.compose)(Object(r.connect)(({location:e,history:t,mostRecentBoard:n,pins:a,ui:o,viewer:r},{pin:{id:i}})=>{const s=a[i],{postRepinMoreIdeasUpsell:c}=o;return{carousel_data:s&&s.carousel_data,previousHistory:t.previous,isLimitedLogin:r.isLimitedLogin,savedInfo:s&&s.savedInfo,selectedItem:s&&s.selectedItem,reduxLocation:e,postRepinMoreIdeasUpsell:c,mostRecentBoard:n,viewerUserId:r.id}},e=>({incrementBoardPinCount:({boardId:t,sectionId:n})=>e(Object(O.d)({boardId:t,sectionId:n,increment:1})),save:t=>e(Object(N.a)(t)),unsave:t=>e(Object(N.d)(t)),selectBoardOrSection:t=>e(Object(N.b)(t)),setMostRecentBoard:(t,n,a)=>e(Object(L.a)(t,n,a)),searchQueryInvalidated:t=>e(Object(j.b)(t)),showRepinAnimation:t=>e(Object(A.c)(t)),updateUserPinCount:t=>e(Object(F.b)({userId:t,increment:1}))})),V.c,Object(z.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:()=>({field_set_key:"board_picker"})}),Object(z.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsShortListResource",options:e=>({pin_id:e.pin.id,shortlist_length:2,num_shortlist_suggestions:2,suggestions_only:!0,min_confidence:.5})}),Q.a)((function(e){const{suggestedBoardsShortListResource:t,initialSelection:n,mostRecentBoard:a}=e,r=Object($.b)();if(n)return o.a.createElement(te,Object.assign({},e,{boardPickerStopwatch:r,postRepinUpsellDisabled:!0,unselectedText:n.title}));const i=t&&t.data&&t.data[0];return o.a.createElement(u.d,{overflow:"hidden"},o.a.createElement(te,Object.assign({},e,{boardPickerStopwatch:r,initialSelection:t&&t.isLoaded&&i&&{boardId:i.id,title:i.name,url:i.url}||t&&t.isLoaded&&!i&&a&&{boardId:a.id,title:a.name,url:a.url}||void 0,unselectedText:t&&t.isLoaded?d.a._("Select","BetterSave label to pick a board from the list","BetterSave label to pick a board from the list"):"..."})))})))},jZhD:function(e,t,n){n.d(t,"a",(function(){return i}));var a=n("q1tI"),o=(n("17x9"),n("pdBG"));function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class i extends a.Component{constructor(...e){super(...e),r(this,"searchCache",Object.create(null)),r(this,"lastSearchedQuery",null),r(this,"search",e=>{this.lastSearchedQuery=e,e in this.searchCache?this.props.onTypeaheadSuggestionsChange(this.searchCache[e],e):this.provider.search(e,({items:t})=>{this.searchCache[e]=t,e===this.lastSearchedQuery&&this.props.onTypeaheadSuggestionsChange(t,e)})})}componentDidMount(){const e=this.props.resourceOptions||{};this.provider=new o.a({resource_name:this.props.resourceName,...e});const{value:t}=this.props;null!=t&&this.props.allowSearchOnMount&&this.search(this.props.value)}UNSAFE_componentWillReceiveProps({value:e}){null!=e&&e!==this.props.value&&this.search(e)}render(){return this.props.children||null}}r(i,"defaultProps",{resourceName:"TypeaheadResource"})},"mVx/":function(e,t,n){var a=n("XKAG")(n("JELi"));e.exports=a},nKlH:function(e,t,n){n.d(t,"a",(function(){return i}));var a=n("q1tI"),o=n.n(a),r=n("n6mq");function i(e){const{accessibilityLabel:t,focused:n,id:i,onBlur:s,onChange:c,onFocus:d,placeholder:l,value:u}=e,h=Object(a.useRef)(null);return Object(a.useEffect)(()=>{if(n){const e=h.current;window.requestAnimationFrame(()=>{const t=e&&e.querySelector("input");t instanceof HTMLInputElement&&t.focus()})}},[n]),o.a.createElement(r.d,{ref:h},o.a.createElement(r.H,{accessibilityLabel:t,id:i,onBlur:s,onChange:c,onFocus:d,placeholder:l,size:"lg",value:u}))}},pdBG:function(e,t,n){var a=n("AHhP"),o=n.n(a);const r=function(e,t){this.uid=e,this.item=t,this.next=null,this.prev=null},i=function(e){this._maxNumItems=e||10,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null};i.prototype.set=function(e,t){let n=this._uidToData[e];n||(n=new r(e,t),this._uidToData[e]=n,this._numItems+=1),this._moveToFront(n),this._numItems>this._maxNumItems&&this._evict()},i.prototype.get=function(e){const t=this._uidToData[e];return t?(this._moveToFront(t),t.item):null},i.prototype.remove=function(e){const t=this._uidToData[e];t&&(delete this._uidToData[e],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},i.prototype._moveToFront=function(e){this._firstData!==e&&(this._firstData?(this._lastData===e&&(this._lastData=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this._firstData.prev=e,e.next=this._firstData,e.prev=null,this._firstData=e):(this._firstData=e,this._lastData=e))},i.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1};var s=i,c=n("eOdZ"),d=n("mBfy");const l=function(e){e=e||{},this.tags=e.tags,this.enable_recent_queries=!!e.enable_recent_queries,this.minimum_term_character_length=e.minimum_term_character_length||0,this.bypass_lru_cache=e.bypass_lru_cache;const t={tags:e.tags,pin:e.pin_id},n=e.num_places;n?t.num_places=n:t.count="count"in e?e.count:5,e.exclude_non_followers&&(t.exclude_non_followers=!0),e.field_set_key&&(t.field_set_key=e.field_set_key),e.pin_scope&&(t.pin_scope=e.pin_scope),e.suggestion_type&&(t.suggestion_type=e.suggestion_type);let a="TypeaheadResource";e.resource_name&&(a=e.resource_name),this.searchResource=c.a.create(a,t),this.itemsCache=new s};Object.assign(l.prototype,o.a),Object.assign(l.prototype,{search(e,t){let n;if(!e&&"pinners_and_contacts"===this.tags)return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&d.default.isLimitedLogin())return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&this.enable_recent_queries&&d.default&&d.default.isAuthenticated())n="recent_search";else{const n=this.bypass_lru_cache?{}:this.itemsCache.get(e);if(n){const a=n.items;if(a&&a.length){this.abortSearch();const o=n.hint;return void this.publishData(e,a,o,t)}}}e.length>=this.minimum_term_character_length?this.fetch(e,n,t):this.publishData(e,[],{},t)},getResource(){return this.searchResource},abortSearch(){this.getResource().abort()},publishData(e,t,n,a){const o={term:e,items:t,hint:n};this.trigger("data",o),a&&a(o)},setAutocompleteScope(e){this.getResource().set("autocompleteScope",e)},fetch(e,t,n){const a=this.getResource();if(a.isCalling()){const t=a.get("term");if(e===t)return;this.abortSearch()}""!==this.tags&&(a.set("term",e),a.set("tags",t||this.tags),a.resetBookmark(),a.callGet({showError:!1}).then(t=>{const a=t.resource_response.data,o=a.items,r=a.hint||{},i={hint:r,items:o};this.cacheData(e,i),this.publishData(e,o,r,n)},e=>{this.trigger("fetchError",e)}),this.warm=!0)},removeCacheForTerm(e){this.itemsCache.remove(e)},cacheData(e,t){this.itemsCache.set(e,t)},prefetch(){if(this.warm)return;c.a.create("TypeaheadPrepareResource").callGet({showError:!1}),this.warm=!0}});t.a=l}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/PinBetterSaveCommon-7b6e2e7960a365762a3d.mjs.map